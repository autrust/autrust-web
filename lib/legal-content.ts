/**
 * Contenu et constantes partagés pour les pages légales.
 * Les placeholders [[...]] sont remplacés par les valeurs de company.
 */

export const LEGAL = {
  company: {
    brand: "Autrust",
    legalForm: "[[SRL]]",
    address: "[[Adresse complète]]",
    zipCityCountry: "[[Code postal]] [[Ville]] — [[Pays]]",
    enterpriseNumber: "[[BE0XXX.XXX.XXX]]",
    vatNumber: "[[BE0XXX.XXX.XXX]]",
    email: "[[contact@autrust.eu]]",
    privacyEmail: "[[privacy@autrust.eu]]",
    accessibilityEmail: "[[accessibility@autrust.eu]]",
    website: "[[www.autrust.eu]]",
    publisher: "[[Nom du responsable de publication]]",
    host: {
      name: "[[Nom hébergeur]]",
      address: "[[Adresse hébergeur]]",
      contact: "[[Contact hébergeur]]",
    },
    effectiveDate: "[[Date d'entrée en vigueur]]",
    jurisdictionCity: "Bruxelles",
  },

  legalNotice: `# Mentions légales

**Éditeur du site**  
[[Autrust]] ([[SRL]])  
Siège social : [[Adresse complète]]  
[[Code postal]] [[Ville]] — [[Pays]]  
Numéro d'entreprise (BCE) : [[BE0XXX.XXX.XXX]]  
TVA : [[BE0XXX.XXX.XXX]] (si applicable)  
E-mail : [[contact@autrust.eu]]  
Site : [[www.autrust.eu]]

**Directeur de publication**  
[[Nom du responsable de publication]]

**Hébergement**  
[[Nom hébergeur]]  
[[Adresse hébergeur]]  
Contact : [[Contact hébergeur]]

Autrust est une plateforme en ligne de mise en relation entre acheteurs et vendeurs de véhicules.  
Autrust n'est ni vendeur, ni acheteur, ni intermédiaire contractuel dans la transaction.`,

  accessibility: `# Déclaration d'accessibilité

Autrust s'engage à rendre son site et ses services numériques accessibles au plus grand nombre, conformément aux normes d'accessibilité applicables, notamment les **WCAG** (niveau AA) et la législation européenne en vigueur.

## État de conformité
Le site Autrust est **partiellement conforme** : certaines fonctionnalités et pages sont en cours d'amélioration.

## Limitations connues
Certaines pages peuvent présenter des difficultés, notamment :
- contenus dynamiques complexes
- certains éléments interactifs récents
- documents ou médias externes

## Amélioration continue
Nous travaillons de manière continue à l'amélioration de l'accessibilité.

## Contact
Si vous rencontrez une difficulté d'accès, contactez-nous :  
[[accessibility@autrust.eu]]

Nous ferons notre possible pour vous proposer une alternative accessible dans les meilleurs délais.`,

  cookies: `# Politique cookies

Autrust utilise des cookies et technologies similaires pour :

- assurer le fonctionnement du site (cookies strictement nécessaires)
- sécuriser la plateforme et prévenir la fraude
- mesurer l'audience et améliorer l'expérience utilisateur
- personnaliser certains contenus (le cas échéant)

## Gestion des préférences
Vous pouvez configurer vos préférences via le bandeau cookies ou les paramètres de votre navigateur.

## Cookies indispensables
Certains cookies sont indispensables au fonctionnement du service et ne peuvent pas être désactivés.`,

  privacy: `# Politique de confidentialité (RGPD)

Autrust traite des données personnelles dans le respect du **Règlement Général sur la Protection des Données (RGPD)**.

## Responsable du traitement
[[Autrust]] ([[SRL]])  
Contact : [[privacy@autrust.eu]]

## Données collectées
Nous pouvons collecter notamment :
- données d'identité et de contact (nom, e-mail, téléphone)
- données de compte (identifiants, paramètres)
- données liées aux annonces (infos véhicule, photos, descriptions)
- communications via la plateforme (messages, signalements)
- données techniques (IP, logs, cookies, appareil, navigateur)

## Finalités
- création et gestion des comptes
- publication et gestion des annonces
- mise en relation entre utilisateurs
- sécurité, prévention des fraudes et abus
- support client
- amélioration des services et statistiques
- obligations légales

## Bases légales
- exécution du contrat (CGU)
- consentement (ex: cookies non essentiels)
- obligations légales
- intérêt légitime (sécurité, anti-fraude, amélioration)

## Destinataires
Vos données peuvent être accessibles :
- à nos prestataires techniques (hébergement, emails, analytics, anti-fraude)
- aux autorités compétentes si la loi l'exige

## Durées de conservation
Les données sont conservées pour la durée nécessaire aux finalités, puis archivées/supprimées selon obligations légales.

## Sécurité
Autrust met en œuvre des mesures techniques et organisationnelles raisonnables pour protéger les données.

## Vos droits
Vous disposez des droits suivants : accès, rectification, effacement, limitation, opposition, portabilité, retrait du consentement.

Pour exercer vos droits : [[privacy@autrust.eu]]`,

  termsPrivate: `# Conditions générales d'utilisation — Utilisateur privé

**Date d'entrée en vigueur : [[Date]]**

## 1. Coordonnées
[[Autrust]] ([[SRL]]) — [[Adresse complète]] — [[BE0XXX.XXX.XXX]] — [[contact@autrust.eu]]

## 2. Champ d'application
Les présentes conditions régissent l'utilisation des services Autrust par les utilisateurs privés (ci-après « l'Utilisateur »).  
L'utilisation du site implique l'acceptation des présentes conditions ainsi que de la Politique de confidentialité.

## 3. Nature des services
Autrust fournit une plateforme permettant :
- la consultation d'annonces
- la publication d'annonces
- la mise en relation entre acheteurs et vendeurs

Autrust n'est **ni vendeur, ni acheteur, ni intermédiaire contractuel**. Le contrat de vente est conclu uniquement entre l'acheteur et le vendeur.

Autrust peut modifier ses services pour des raisons techniques, légales ou d'amélioration.

## 4. Inscription et compte
Certaines fonctionnalités nécessitent un compte.  
L'inscription est réservée aux personnes majeures et juridiquement capables.  
Les informations fournies doivent être exactes et à jour.  
L'utilisateur est responsable de la confidentialité de ses identifiants.  
Autrust peut supprimer les comptes inactifs depuis plus de 12 mois.

## 5. Publication d'annonces
L'utilisateur peut publier des annonces pour des véhicules qu'il possède ou est autorisé à vendre.  
Les informations doivent être exactes, complètes et conformes à la réalité.  
L'annonce doit être supprimée ou mise à jour dès la vente du véhicule.

Autrust peut refuser/modifier/supprimer toute annonce non conforme, frauduleuse, trompeuse, ou contraire à la loi.

## 6. Responsabilité du contenu
L'utilisateur est seul responsable du contenu publié et garantit :
- conformité à la loi
- respect des droits de tiers
- absence de contenu illicite/offensant
- description fidèle du véhicule

Sont notamment interdits :
- annonces fictives / indisponibles
- prix trompeur / 1€ / "à discuter" mensonger
- photos de catalogue ou non représentatives
- liens externes promotionnels
- numéros surtaxés
- annonces "recherche" (demande) au lieu de "vente"

## 7. Modération, blocage et signalements
Autrust peut réaliser des contrôles manuels et/ou automatisés.  
Un système de signalement permet de notifier un contenu suspect/illégal.

En cas de violation, Autrust peut :
- supprimer ou limiter la visibilité d'un contenu
- demander une correction
- suspendre la publication
- suspendre ou supprimer un compte

Les mesures dépendent de la gravité et de la récidive.

## 8. Droits d'utilisation sur le contenu
En publiant du contenu, l'utilisateur accorde à Autrust un droit non exclusif et gratuit de :
- stocker et afficher le contenu
- le reproduire/diffuser à des fins de fonctionnement et promotion
- l'adapter techniquement (formats, recadrage, etc.)

## 9. Propriété intellectuelle / base de données
Le site, la base de données, les logos et contenus Autrust sont protégés.  
Toute extraction massive, scraping ou réutilisation commerciale des données est interdite.

## 10. Absence de garantie
Autrust ne garantit pas l'exactitude des informations publiées par les utilisateurs ni l'état des véhicules.  
Autrust n'est pas responsable des litiges, défauts, fraudes ou échecs de transaction entre utilisateurs.

## 11. Sécurité et prévention des fraudes
Les utilisateurs doivent être prudents : vérifier identité, privilégier rencontre, éviter acomptes sans garanties, confirmer paiement avant remise du véhicule.

Autrust peut mettre en place des mécanismes anti-fraude (badge, vérification, score de confiance).

## 12. Responsabilité d'Autrust
Autrust n'est responsable qu'en cas de faute intentionnelle ou négligence grave, dans les limites légales applicables.  
Autrust ne garantit pas une disponibilité continue du service.

## 13. Services payants optionnels (si applicable)
Si des options payantes sont proposées, leurs conditions seront affichées au moment de l'achat. Les droits légaux de rétractation s'appliquent selon les règles applicables.

## 14. Rapports d'historique véhicule (CarVertical)
L'achat de rapports d'historique de véhicules fournis par CarVertical est soumis à une **clause spécifique** (nature du service, absence de garantie, renonciation à la rétractation, responsabilité). Cette clause est disponible sur une [page dédiée](/legal/report-history) et doit être acceptée avant l'achat.

## 15. Droit applicable et juridiction
Droit belge. Compétence : tribunaux de [[Bruxelles]] sous réserve des règles impératives de protection du consommateur.`,

  termsPro: `# Conditions générales — Utilisateurs professionnels

**Date d'entrée en vigueur : [[Date]]**

Ces conditions s'appliquent aux concessionnaires, garages, marchands et tout vendeur agissant à titre professionnel.

## 1. Accès et compte professionnel
L'accès professionnel peut nécessiter un abonnement, une validation, et/ou des justificatifs.  
Le professionnel garantit l'exactitude des informations de son compte (BCE, TVA, adresse, etc.).

## 2. Obligations professionnelles
Le professionnel s'engage à :
- respecter la législation applicable (information, prix, garanties, pratiques commerciales)
- fournir des informations exactes et non trompeuses
- indiquer clairement les prix **TTC** lorsque requis
- respecter ses engagements vis-à-vis des acheteurs

## 3. Publication et gestion des annonces
Autrust peut proposer :
- annonces sponsorisées
- gestion de stock
- outils de reporting
- services de vérification (VIN/historique/inspection)

Autrust peut suspendre un compte en cas de fraude, abus, duplication, ou pratiques trompeuses.

## 4. Paiements et services
Les tarifs, modalités et options sont décrits dans les conditions commerciales.  
Autrust reste un prestataire technique et n'est pas partie à la vente.

## 5. Modération et sanctions
Autrust peut limiter, supprimer, ou bloquer du contenu ou un compte selon la gravité et la récidive.

## 6. Droit applicable
Droit belge. Juridiction : [[Bruxelles]] (sauf dispositions impératives).`,

  payments: `# Conditions de paiement / acompte (si activé)

Autrust peut proposer des services payants et/ou des solutions de paiement ou d'acompte sécurisé via des prestataires tiers.

Autrust agit comme prestataire technique et n'est pas partie au contrat de vente entre acheteur et vendeur.

Les fonds peuvent être conservés temporairement selon le fonctionnement du prestataire et les conditions affichées lors du paiement.

En cas de litige, les procédures du prestataire de paiement et les règles affichées lors de la transaction s'appliquent.

Autrust ne garantit pas l'issue de la vente et n'est pas responsable des manquements contractuels entre utilisateurs.

Pour les **rapports d'historique véhicule** (CarVertical), une clause spécifique s'applique. Voir : [Rapports d'historique véhicule (CarVertical)](/legal/report-history).`,

  reportHistory: `# Clause spécifique — Rapports d'historique véhicule (CarVertical)

Autrust propose l'accès à des rapports d'historique de véhicules fournis par la société **CarVertical**, prestataire tiers indépendant spécialisé dans la collecte et l'analyse de données automobiles.

Autrust agit uniquement en qualité d'intermédiaire technique permettant l'acquisition et la transmission de ces rapports et n'est ni l'éditeur, ni le producteur, ni le fournisseur des informations qu'ils contiennent.

Les données figurant dans les rapports proviennent de sources externes multiples (administrations publiques, assureurs, bases de données privées, partenaires commerciaux, etc.) dont la fiabilité, l'exactitude et l'exhaustivité ne peuvent être garanties.

En conséquence :

* Autrust ne garantit ni l'exactitude, ni l'exhaustivité, ni l'actualité des informations contenues dans les rapports.
* Les rapports sont fournis à titre strictement informatif et ne constituent pas une expertise technique, mécanique, juridique ou commerciale du véhicule.
* L'absence d'information dans un rapport ne signifie pas nécessairement l'absence d'incident, d'accident, de modification ou d'historique concernant le véhicule.
* L'utilisateur demeure seul responsable des décisions prises sur la base des informations fournies.

Autrust ne saurait être tenu responsable :

* des erreurs, omissions ou inexactitudes présentes dans les rapports ;
* des dommages directs ou indirects résultant de leur utilisation ;
* des litiges entre acheteurs et vendeurs ;
* de toute décision d'achat, de vente ou d'évaluation fondée sur ces informations.

Les conditions d'utilisation et la politique de confidentialité de CarVertical sont consultables sur leur site officiel :
https://www.carvertical.com/legal/terms-and-conditions

Les rapports constituent un contenu numérique fourni immédiatement après paiement. En validant l'achat, l'utilisateur reconnaît expressément que l'exécution du service commence immédiatement et renonce à son droit de rétractation conformément à la législation applicable aux contenus numériques.

Toute reproduction, diffusion ou utilisation commerciale du rapport sans l'autorisation du titulaire des droits est interdite.`,
};

export const LEGAL_ROUTES = {
  termsPrivate: "/legal/terms-private",
  termsPro: "/legal/terms-pro",
  legalNotice: "/legal/legal-notice",
  privacy: "/legal/privacy",
  cookies: "/legal/cookies",
  accessibility: "/legal/accessibility",
  payments: "/legal/payments",
  reportHistory: "/legal/report-history",
} as const;

type Company = typeof LEGAL.company;

/** Map des placeholders [[clé]] -> valeur (clé sans les crochets) */
function getPlaceholderMap(company: Company): Map<string, string> {
  const host = company.host;
  const map = new Map<string, string>([
    ["Autrust", company.brand],
    ["SRL", company.legalForm],
    ["Adresse complète", company.address],
    ["Code postal", company.zipCityCountry],
    ["Ville", company.zipCityCountry],
    ["Pays", company.zipCityCountry],
    ["BE0XXX.XXX.XXX", company.enterpriseNumber],
    ["contact@autrust.eu", company.email],
    ["www.autrust.eu", company.website],
    ["Nom du responsable de publication", company.publisher],
    ["Nom hébergeur", host.name],
    ["Adresse hébergeur", host.address],
    ["Contact hébergeur", host.contact],
    ["Date d'entrée en vigueur", company.effectiveDate],
    ["Date", company.effectiveDate],
    ["Bruxelles", company.jurisdictionCity],
    ["privacy@autrust.eu", company.privacyEmail],
    ["accessibility@autrust.eu", company.accessibilityEmail],
  ]);
  return map;
}

/**
 * Remplace les placeholders [[...]] dans le texte par les valeurs de company.
 */
export function replaceLegalPlaceholders(
  text: string,
  company: Company = LEGAL.company
): string {
  const map = getPlaceholderMap(company);
  return text.replace(/\[\[([^\]]+)\]\]/g, (_, key: string) => map.get(key.trim()) ?? `[[${key}]]`);
}

/** Contenu markdown avec placeholders remplacés (pour affichage) */
export function getLegalMarkdown(
  key: keyof Omit<typeof LEGAL, "company">,
  company: Company = LEGAL.company
): string {
  const raw = LEGAL[key];
  if (typeof raw !== "string") return "";
  return replaceLegalPlaceholders(raw, company);
}
